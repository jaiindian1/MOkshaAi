<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moksha AI: Universal Dharma Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@google/genai@0.1.0/dist/index.min.js"></script> 
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f3e8; /* Light sand/saffron background */
        }
        .moksha-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 24px;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        .om-symbol {
            font-size: 8rem;
            line-height: 1;
            color: #ffbf00; /* Deep Saffron/Amber */
            text-shadow: 0 4px 6px rgba(128, 0, 0, 0.4);
            animation: pulse 4s infinite ease-in-out;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }
        .input-area {
            min-height: 150px;
            background-color: #fff8e8;
            border: 2px solid #ffbf00;
            transition: all 0.3s;
        }
        .input-area:focus {
            border-color: #800000;
            box-shadow: 0 0 0 3px rgba(128, 0, 0, 0.2);
        }
        .seek-button {
            background-color: #800000; /* Deep Maroon */
            transition: background-color 0.3s, transform 0.1s;
        }
        .seek-button:hover {
            background-color: #a02040;
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(128, 0, 0, 0.3);
        }
        .loading-bar {
            overflow: hidden;
            height: 4px;
            background-color: #ffbf0050;
            border-radius: 2px;
        }
        .loading-bar-inner {
            width: 100%;
            height: 100%;
            background-color: #800000;
            animation: loading-animation 1.5s infinite linear;
            transform-origin: left;
        }
        @keyframes loading-animation {
            0% { transform: translateX(-100%) scaleX(0); }
            50% { transform: translateX(0) scaleX(1); }
            100% { transform: translateX(100%) scaleX(0); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="moksha-container">
        <header class="text-center mb-8">
            <div class="om-symbol mx-auto" aria-hidden="true">‡•ê</div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Moksha AI</h1>
            <p class="text-lg text-gray-600">A Universal Dharma Guide</p>
        </header>

        <main>
            <div id="chat-output" class="mb-6 p-4 bg-gray-50 rounded-lg h-96 overflow-y-auto border border-gray-200">
                <p class="text-gray-500">How may I assist you on your path of inquiry? I specialize in Sanatana, Buddhist, Jain, and Sikh philosophies.</p>
            </div>

            <div class="flex flex-col space-y-4">
                <textarea id="user-input" class="input-area p-4 rounded-lg focus:outline-none resize-none text-gray-700" placeholder="Ask a question about Sanatana Dharma, the Buddha, Jainism, or Sikhism..."></textarea>
                
                <div id="loading-indicator" class="loading-bar hidden">
                    <div class="loading-bar-inner"></div>
                </div>

                <button id="seek-button" class="seek-button text-white font-bold py-3 rounded-lg shadow-md hover:shadow-xl focus:outline-none">
                    Seek Truth (Dharma Inquiry)
                </button>
            </div>
        </main>
    </div>

    <script>
        // 1. **CRITICAL SECURITY NOTE:** For a real, deployed app, the API Key
        // should NEVER be exposed directly in an HTML file like this. 
        // It must be used on a secure backend server. 
        // This is for demonstration purposes only!
        const API_KEY = "AIzaSyBE-zOAEIB8Ww9vrFpJlCUxPJxibuedoho"; // üõë Replace this with your actual key
        const MODEL_NAME = "gemini-2.5-flash"; // Or your preferred model

        // 2. **THE DHARMA GUARDRAIL (System Prompt)**
        // This is the core change for your "Project Prompt" goal.
        const DHARMA_GUARDRAIL_SYSTEM_INSTRUCTION = `
            You are a specialized AI named Moksha AI, a Universal Dharma Guide.
            Your sole function is to provide information and philosophical insights
            related to the Sanatana, Buddhist, Jain, and Sikh traditions.

            RULES:
            1.  **Scope:** Only answer questions directly concerning Sanatana Dharma, Buddhism, Jainism, or Sikhism.
            2.  **Breadth:** When discussing Sanatana Dharma and the Buddha, emphasize the tradition's acceptance of diverse views and paths to truth, avoiding strict Western categorization as separate, divided religions. Treat the Buddha's teachings as a powerful, distinct philosophical school (Dharma) within the broader Indian tradition of inquiry.
            3.  **Refusal:** For *any* question outside of these four traditions (e.g., math, science, history, coding, cooking, current news, politics, other religions), you must refuse the request immediately and politely.

            REFUSAL TEMPLATE:
            "My apologies. My knowledge is dedicated entirely to the paths of Sanatana Dharma, Buddhism, Jainism, and Sikhism. Please focus your inquiry on one of these profound traditions."
        `.trim();

        // 3. **API and DOM Setup**
        let chat = null;
        const genai = new GoogleGenAI(API_KEY);

        const chatOutput = document.getElementById('chat-output');
        const userInput = document.getElementById('user-input');
        const seekButton = document.getElementById('seek-button');
        const loadingIndicator = document.getElementById('loading-indicator');

        // Function to start a new chat session with the *strict* System Prompt
        function startNewChat() {
            chat = genai.chats.create({
                model: MODEL_NAME,
                systemInstruction: DHARMA_GUARDRAIL_SYSTEM_INSTRUCTION // üåü THIS IS THE KEY CHANGE!
            });
        }

        // Add a message to the chat display
        function addMessage(role, text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = role === 'user' 
                ? 'text-right mb-2' 
                : 'text-left mb-2';
            
            const contentSpan = document.createElement('span');
            contentSpan.className = role === 'user' 
                ? 'inline-block bg-maroon-600 text-white p-3 rounded-lg max-w-lg shadow-md seek-button'
                : 'inline-block bg-gray-200 text-gray-800 p-3 rounded-lg max-w-lg shadow-md';
            
            // Simple markdown/line break handling
            contentSpan.innerHTML = text.replace(/\n/g, '<br>');

            messageDiv.appendChild(contentSpan);
            chatOutput.appendChild(messageDiv);
            chatOutput.scrollTop = chatOutput.scrollHeight;
        }

        // Main function to handle the button click
        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // Clear input and show loading
            userInput.value = '';
            addMessage('user', message);
            seekButton.disabled = true;
            seekButton.textContent = "Processing Wisdom...";
            loadingIndicator.classList.remove('hidden');

            try {
                // Send the message using the chat instance that has the system instruction
                const response = await chat.sendMessage({ message: message });
                const responseText = response.text;

                addMessage('model', responseText);
            } catch (error) {
                console.error("AI Error:", error);
                addMessage('model', "A deeper insight is required. There was an error reaching the source of knowledge.");
            } finally {
                // Reset button and hide loading
                seekButton.disabled = false;
                seekButton.textContent = "Seek Truth (Dharma Inquiry)";
                loadingIndicator.classList.add('hidden');
                userInput.focus();
            }
        }

        // Event Listeners
        seekButton.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // Start the chat when the page loads
        document.addEventListener('DOMContentLoaded', () => {
             // Initialize the chat on load
            startNewChat();
            
            // Set initial message
            const welcomeMessage = document.querySelector('#chat-output p');
            if (welcomeMessage) {
                welcomeMessage.textContent = "Welcome to Moksha AI. I specialize in Sanatana, Buddhist, Jain, and Sikh philosophies. How may I assist your path of inquiry?";
            }
        });

    </script>
</body>
</html>
